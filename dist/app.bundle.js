(()=>{"use strict";class t{constructor(){this.list=document.querySelector(".items"),this.fragment=new DocumentFragment}createElements=t=>{this.number=1,t&&(this.list.innerHTML="",t.forEach((t=>{this.div=document.createElement("div"),this.div.classList.add("row"),this.div.setAttribute("id",`${this.number}`),this.number+=1,this.checkbox=document.createElement("input"),this.checkbox.setAttribute("type","checkbox"),this.checkbox.classList.add("no-fluid"),this.checkbox.classList.add("click"),this.checkbox.classList.add("checkbox"),this.checkbox.checked=t.bool,this.rowForm=document.createElement("form"),this.textarea=document.createElement("textarea"),this.textarea.style.cssText="border: none;",this.textarea.setAttribute("readonly",!0),this.textarea.setAttribute("draggable",!0),this.textarea.setAttribute("required",!0),t.bool?this.textarea.style.textDecoration="line-through":this.checkbox.style.textDecoration="none",this.textarea.value=`${t.string}`,this.textarea.classList.add("string"),this.button=document.createElement("button"),this.button.style.display="none",this.more=document.createElement("span"),this.more.classList="more",this.more.dataset.data="rmv",this.more.innerHTML="&#65049;",this.bin=document.createElement("span"),this.bin.innerHTML="&#128465;",this.bin.classList="bin",this.bin.id="bin",this.checkbox.classList.add("click"),this.bin.classList.add("no-fluid"),this.rowForm.append(this.textarea,this.button),this.div.append(this.checkbox,this.rowForm,this.more,this.bin),this.fragment.appendChild(this.div)})),this.list.append(this.fragment))};display=t=>{this.createElements(t)};getSearchValue=t=>{this.form=document.querySelector("form"),this.search=document.querySelector(".search"),this.form.addEventListener("submit",(e=>{e.preventDefault(),t(this.search),this.search.value=""}))};listenToCheckBox=t=>{this.body=document.querySelector("body"),this.body.addEventListener("change",(e=>"checkbox"===e.target.type?t(e):" "))};getRemoveBtn=t=>{this.removeBtn=document.querySelectorAll(".bin"),this.removeBtn.forEach((()=>{document.addEventListener("click",(e=>{"bin"===e.target.id&&t(e)}))}))};editList(t){this.more=document.querySelectorAll(".more"),this.body=document.querySelector("body"),this.more.forEach((e=>{this.body.addEventListener("click",(s=>(this.data=e.dataset.data,this.clickedData=s.target.dataset.data,this.data===this.clickedData?t(s):"")))}))}}class e{constructor(){this.tasks=JSON.parse(localStorage.getItem("todos"))||[],this.update()}setStorage=t=>{localStorage.setItem("todos",JSON.stringify(t))};bindChange=t=>{this.change=t};update(t){this.change(t),this.setStorage(t)}addTodo=t=>{t&&("line-through"===t.style.textDecoration?this.bool=!0:this.bool=!1,this.newArray={string:t.value,bool:this.bool,number:this.tasks.length>0?this.tasks[this.tasks.length-1].number+1:1},this.array=this.tasks.push(this.newArray),this.update(this.tasks))};toggleTodo=t=>{this.string=t.target.nextElementSibling.firstElementChild.value;for(let e=0;e<this.tasks.length;e+=1)!0===t.target.checked&&this.string===this.tasks[e].string?this.tasks[e].bool=!0:!1===t.target.checked&&this.string===this.tasks[e].string&&(this.tasks[e].bool=!1);this.setStorage(this.tasks)};changeStatusValue(t,e,s){this.tasks.forEach((i=>{this.parentId=e.parentElement.parentElement.id,parseInt(this.parentId,10)===parseInt(t,10)&&parseInt(t,10)===i.number&&(i.string=s)})),this.update(this.tasks)}removeTodo(t){this.parent=t.target.parentElement,this.string=this.parent.firstElementChild.nextElementSibling.firstElementChild.value,this.tasks.forEach(((t,e)=>{this.string===t.string&&this.tasks.splice(e,1),t.number=e+1,this.update(this.tasks)}))}}new class{constructor(t,e,s){this.model=e,this.view=t,this.checkbox=s,this.model.bindChange(this.handleChange),this.handleChange(this.model.tasks),this.view.getSearchValue(this.handleAddEvent),this.view.listenToCheckBox(this.handleCheckEvent),this.view.editList(this.handleEditList),this.checkbox.getObjects(this.model.tasks),this.handleCompleted()}handleChange=t=>{this.view.display(t)};handleAddEvent=t=>{this.model.addTodo(t),this.view.editList(this.handleEditList)};handleEditList=t=>{t.target.style.display="none",this.bin=t.target.nextElementSibling,this.bin.style.display="block",this.textarea=t.target.previousElementSibling.firstElementChild,this.textarea.readOnly=!1,this.parent=t.target.parentElement,this.parent.style.cssText="background-color: rgb(248, 239, 169);",this.view.getRemoveBtn(this.passRemoveBtn),this.body=document.querySelector("body"),this.body.addEventListener("keypress",this.passVal=t=>{"Enter"!==t.key||document.querySelector(".search").value||(t.preventDefault(),this.textarea.value&&this.model.changeStatusValue(this.textarea.parentElement.parentElement.id,this.textarea,this.textarea.value))})};handleCheckEvent=t=>{this.model.toggleTodo(t),this.checkbox.strike(t)};passRemoveBtn=t=>{this.model.removeTodo(t),this.view.display(this.model.tasks)};handleCompleted=()=>{this.clear=document.querySelector(".clear"),this.row=document.querySelectorAll("textarea"),this.clear.addEventListener("click",(()=>{this.model.tasks.forEach(((t,e)=>{!0===t.bool&&this.model.tasks.splice(e,1),t.number=e+1,this.model.update(this.model.tasks)}))}))}}(new t,new e,new class{constructor(){this.view=new t,this.model=new e}getObjects=t=>{this.tasks=t};strike=t=>{this.status=t.target.checked,this.string=t.target.nextElementSibling.firstElementChild;for(let t=0;t<this.tasks.length;t+=1)this.status?this.string.style.textDecoration="line-through":this.string.style.textDecoration="none"}}).handleCompleted()})();